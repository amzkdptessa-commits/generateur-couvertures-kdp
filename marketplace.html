<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-fr="Marketplace - GabaritKDP" data-en="Marketplace - GabaritKDP">Marketplace - GabaritKDP</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif; background-color: #fff;}

   /* HEADER STANDARD */
.header-nav {
  background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
  padding: 15px 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, .1);
  position: sticky;
  top: 0;
  z-index: 999;
}

.nav-container {
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 20px;
  flex-wrap: wrap;
  position: relative;
}
.language-selector {
  position: absolute;
  top: 12px;
  right: 20px;
  z-index: 1000;
}

.logo-nav {
  display: flex;
  align-items: center;
  gap: 15px;
  text-decoration: none;
  color: #fff;
  flex-shrink: 0;
}

.logo-nav img {
  height: 40px;
  width: auto;
}

.logo-nav span {
  font-size: 1.3rem;
  font-weight: 700;
  color: #FF9900;
}

.nav-links {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 25px;
  flex-wrap: wrap;
}

.nav-links a {
  color: #fff;
  text-decoration: none;
  font-weight: 500;
  transition: .3s;
  padding: 10px 14px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: .95rem;
}

.nav-links a:hover {
  color: #FF9900;
  background: rgba(255, 153, 0, .1);
}

.nav-links a.active {
  color: #FF9900;
  background: rgba(255, 153, 0, .15);
}

.express-nav-btn {
  background: linear-gradient(135deg, #10b981, #059669) !important;
  color: #fff !important;
  border-radius: 8px !important;
  padding: 10px 14px !important;
}

.language-selector {
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, .1);
  padding: 3px;
  display: flex;
  gap: 2px;
}

.lang-btn {
  padding: 6px 10px;
  border: none;
  background: transparent;
  border-radius: 16px;
  cursor: pointer;
  transition: .3s;
  font-weight: 500;
  font-size: .8rem;
}

.lang-btn.active {
  background: #FF9900;
  color: #fff;
}

/* Responsive */
@media (max-width: 1024px) {
  .nav-links { display: none; }
}

    /* CARDS */
    .premium_edit_sec { background:linear-gradient(135deg,#1e293b 0%,#334155 100%); padding: 40px 0; }
    .category-card { position:relative; border-radius:12px; overflow:hidden; aspect-ratio:4/3; cursor:pointer; transition:0.3s; box-shadow:0 4px 15px rgba(0,0,0,0.15); background:#2d3748; }
    .category-card:hover { transform:translateY(-5px); }
    .category-card img { width:100%; height:100%; object-fit:cover; }
    .category-overlay { position:absolute; inset:0; background:linear-gradient(to top, rgba(0,0,0,0.85) 0%, transparent 60%); display:flex; flex-direction:column; justify-content:flex-end; padding:1rem; pointer-events:none; }
    .category-name { font-size:0.9rem; font-weight:700; color:#fff; margin-bottom:.2rem; text-transform: uppercase; }
    .category-badge { position:absolute; top:0.8rem; right:0.8rem; padding:.2rem .6rem; border-radius:9999px; font-size:.55rem; font-weight:800; color:#fff; pointer-events:none; }
    .badge-premium { background:linear-gradient(135deg,#dc2626,#b91c1c); }
    .badge-popular { background:#f59e0b; }
    .badge-best { background:#8b5cf6; }
    .category-overlay button, .category-overlay a { pointer-events: auto; }

    /* FOOTER */
    footer { background: #0f172a; color: #cbd5e1; padding: 40px 20px 20px; font-size: 1.05rem; }
    .social-box { background:rgba(255,255,255,0.03); border-radius:12px; padding:15px; text-align:center; margin-bottom:25px; border: 1px solid rgba(255,255,255,0.05); }
    .social-links { display:flex; justify-content:center; gap:10px; margin-top:10px; }
    .social-link { width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; color:#fff; font-size:0.9rem; transition:.3s; text-decoration:none; }
    .youtube { background:#FF0000; } .facebook { background:#1877F2; } .instagram { background:linear-gradient(45deg,#405DE6,#833AB4,#FD1D1D); }
    .pinterest { background:#BD081C; } .tiktok { background:#000; border:1px solid #444; } .linkedin { background:#0A66C2; }
</style>
</head>
<body>
  <!-- Netlify Forms detection -->
  <form name="template_requests" method="POST" data-netlify="true" action="/thanks.html" hidden>
    <input type="hidden" name="form-name" value="template_requests">
  </form>

  <header class="header-nav notranslate">
    <div class="nav-container">
      <a href="./index.html" class="logo-nav">
        <img src="logo-gabarit-kdp-site-web.png" alt="Logo">
        <span>GabaritKDP</span>
      </a>
      <nav class="nav-links">
        <a href="./index.html" data-fr="üè† Accueil" data-en="üè† Home">üè† Home</a>
        <a href="./dashboard.html" data-fr="üìä Dashboard" data-en="üìä Dashboard">üìä Dashboard</a>
        <a href="./generator.html" class="express-nav-btn" data-fr="G√©n√©rateur Express" data-en="Express Generator">Express Generator</a>
        <a href="./generator-magic.html" data-fr="G√©n√©rateur Magique" data-en="Magic Generator">Magic Generator</a>
        <a href="./marketplace.html" class="active" data-fr="üìö Templates" data-en="üìö Templates">üìö Templates</a>
        <a href="./inscription.html" data-fr="üìù Inscription" data-en="üìù Sign Up">üìù Sign Up</a>
        <a href="./connexion.html" data-fr="üîì Connexion" data-en="üîì Login">üîì Login</a>
      </nav>
      <div class="language-selector">
        <button class="lang-btn" data-lang="fr" onclick="switchLanguage('fr')">FR</button>
        <button class="lang-btn active" data-lang="en" onclick="switchLanguage('en')">US</button>
      </div>
    </div>
  </header>

  <section class="py-10 bg-slate-50 text-center border-b border-gray-100">
    <h1 class="text-3xl md:text-4xl font-black text-gray-900 mb-2">
      <span data-fr="Mod√®les" data-en="Templates">Templates</span>
      <span style="color:#FF9900;">KDP</span>
    </h1>
    <p class="text-md text-gray-500" data-fr="6600+ templates professionnels" data-en="6600+ professional templates for your Amazon KDP books">6600+ professional templates for your Amazon KDP books</p>
  </section>

  <!-- SECTION 1: PREMIUM -->
  <section class="premium_edit_sec">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-2xl font-bold text-white text-center mb-8 uppercase tracking-widest">üî• Premium Edition</h2>
      <div id="grid-premium" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
    </div>
  </section>

  <!-- SECTION 2: BOOK COVERS -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-2xl font-bold text-center mb-8 text-gray-900 uppercase tracking-widest">üìö Book Covers (Backgrounds)</h2>
      <div id="grid-backgrounds" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>
    </div>
  </section>

  <!-- SECTION 3: BOOK INTERIORS -->
  <section class="py-16 bg-slate-50 border-t border-gray-100">
    <div class="max-w-7xl mx-auto px-4">
      <h2 class="text-2xl font-bold text-center mb-8 text-gray-900 uppercase tracking-widest" data-fr="üìñ Int√©rieurs de Livres" data-en="üìñ Book Interiors">üìñ Book Interiors</h2>
      <div id="grid-interiors" class="grid grid-cols-1 md:grid-cols-2 max-w-4xl mx-auto gap-8"></div>
    </div>
  </section>

  <!-- SECTION 4: PIXABAY (Am√©lior√©e) -->
  <section class="py-16 bg-white border-t border-gray-100">
    <div class="max-w-7xl mx-auto px-4">
      
      <!-- En-t√™te avec mention du nombre d'images -->
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-gray-900 uppercase tracking-widest mb-2">
          üñºÔ∏è Pixabay Inspirations
        </h2>
        <p class="text-gray-500 font-medium" 
           data-fr="D√©couvrez plus de 4.4 millions d'images et vid√©os de haute qualit√© partag√©es par notre talentueuse communaut√©."
           data-en="Discover over 4.4 million+ high quality images and videos shared by our talented community.">
           Discover over 4.4 million+ high quality images and videos shared by our talented community.
        </p>
      </div>

      <!-- Barre d'outils et Filtres -->
      <div class="bg-slate-50 p-6 rounded-xl border border-gray-200 shadow-sm mb-8">
        
        <!-- Ligne 1 : Recherche et Bouton -->
        <div class="flex flex-col md:flex-row gap-4 mb-4">
          <div class="flex-grow relative">
            <i class="fa-solid fa-magnifying-glass absolute left-4 top-3.5 text-gray-400"></i>
            <input id="gkdp-pixabay-query"
                   class="w-full border border-gray-300 rounded-lg pl-10 pr-4 py-3 focus:ring-2 focus:ring-orange-400 focus:outline-none"
                   type="text"
                   placeholder="ex: lion, galaxy, vintage flower...">
          </div>
          <button id="gkdp-pixabay-search-btn"
                  class="px-8 py-3 rounded-lg text-white font-bold transition hover:shadow-lg flex items-center justify-center gap-2"
                  style="background:#FF9900;">
            <span data-fr="Rechercher" data-en="Search">Search</span>
          </button>
        </div>

        <!-- Ligne 2 : Filtres avanc√©s -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-3">
          
          <!-- Format (Sp√©cifique KDP) -->
          <div class="col-span-2 md:col-span-1">
             <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block">Format KDP</label>
             <div class="flex bg-white rounded-lg border border-gray-300 p-1">
                <button type="button" id="gkdp-pixabay-tab-v" class="flex-1 text-xs py-2 rounded font-bold text-center transition active">Portrait</button>
                <button type="button" id="gkdp-pixabay-tab-h" class="flex-1 text-xs py-2 rounded font-bold text-center transition">Landscape</button>
             </div>
          </div>

          <!-- Type d'image -->
          <div>
            <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block" data-fr="Type" data-en="Type">Type</label>
            <select id="pix-type" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white cursor-pointer hover:border-orange-400">
              <option value="all" data-fr="Toutes" data-en="All images">All images</option>
              <option value="photo" data-fr="Photos" data-en="Photos">Photos</option>
              <option value="illustration" data-fr="Illustrations" data-en="Illustrations">Illustrations</option>
              <option value="vector" data-fr="Vectoriels" data-en="Vectors">Vectors</option>
            </select>
          </div>

          <!-- Cat√©gorie -->
          <div>
            <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block" data-fr="Cat√©gorie" data-en="Category">Category</label>
            <select id="pix-category" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white cursor-pointer hover:border-orange-400">
              <option value="" data-fr="Toutes" data-en="All">All</option>
              <option value="backgrounds">Backgrounds</option>
              <option value="nature">Nature</option>
              <option value="science">Science</option>
              <option value="education">Education</option>
              <option value="feelings">Feelings</option>
              <option value="health">Health</option>
              <option value="people">People</option>
              <option value="religion">Religion</option>
              <option value="places">Places</option>
              <option value="animals">Animals</option>
              <option value="business">Business</option>
            </select>
          </div>

          <!-- Couleurs -->
          <div>
            <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block" data-fr="Couleur" data-en="Color">Color</label>
            <select id="pix-color" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white cursor-pointer hover:border-orange-400">
              <option value="" data-fr="Toutes" data-en="Any Color">Any Color</option>
              <option value="grayscale" data-fr="Noir & Blanc" data-en="Black & White">Black & White</option>
              <option value="transparent" data-fr="Transparent" data-en="Transparent">Transparent</option>
              <option value="red" data-fr="Rouge" data-en="Red">üî¥ Red</option>
              <option value="orange" data-fr="Orange" data-en="Orange">üü† Orange</option>
              <option value="yellow" data-fr="Jaune" data-en="Yellow">üü° Yellow</option>
              <option value="green" data-fr="Vert" data-en="Green">üü¢ Green</option>
              <option value="turquoise" data-fr="Turquoise" data-en="Turquoise">üîµ Turquoise</option>
              <option value="blue" data-fr="Bleu" data-en="Blue">üîµ Blue</option>
              <option value="lilac" data-fr="Lilas" data-en="Lilac">üü£ Lilac</option>
              <option value="pink" data-fr="Rose" data-en="Pink">üå∏ Pink</option>
            </select>
          </div>

          <!-- Tri -->
          <div>
            <label class="text-xs font-bold text-gray-500 uppercase ml-1 mb-1 block" data-fr="Trier par" data-en="Order by">Order by</label>
            <select id="pix-order" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-white cursor-pointer hover:border-orange-400">
              <option value="popular" data-fr="Populaires" data-en="Popular">Popular</option>
              <option value="latest" data-fr="R√©cents" data-en="Latest">Latest</option>
            </select>
          </div>

        </div>
      </div>

      <!-- Grille de r√©sultats -->
      <div id="gkdp-pixabay-grid" class="grid grid-cols-2 md:grid-cols-4 gap-6"></div>

      <!-- Pagination / Loading -->
      <div class="text-center mt-8">
         <p class="text-xs text-gray-400">
            Images provided by <a href="https://pixabay.com" target="_blank" class="underline hover:text-gray-600">Pixabay</a>.
         </p>
      </div>
    </div>
  </section>

  <footer class="bg-gray-900 text-gray-300 py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="social-section">
        <h4 class="text-white font-semibold mb-4 text-center"
            data-en="üöÄ Follow us for the latest KDP news!"
            data-fr="üöÄ Suivez-nous pour les derni√®res actualit√©s KDP !">
          üöÄ Follow us for the latest KDP news!
        </h4>
        <div class="social-links">
          <a href="https://www.youtube.com/@Gabaritkdp" class="social-link youtube" target="_blank"><i class="fab fa-youtube"></i></a>
          <a href="https://www.facebook.com/profile.php?id=61578785408904" class="social-link facebook" target="_blank"><i class="fab fa-facebook-f"></i></a>
          <a href="https://www.instagram.com/gabaritkdp/" class="social-link instagram" target="_blank"><i class="fab fa-instagram"></i></a>
          <a href="https://fr.pinterest.com/Gabaritkdp/" class="social-link pinterest" target="_blank"><i class="fab fa-pinterest-p"></i></a>
          <a href="https://www.tiktok.com/@gabaritkdp" class="social-link tiktok" target="_blank"><i class="fab fa-tiktok"></i></a>
          <a href="https://www.linkedin.com/in/gabarit-kdp-073368378/" class="social-link linkedin" target="_blank"><i class="fab fa-linkedin-in"></i></a>
        </div>
      </div>
      <div class="grid md:grid-cols-4 gap-8 mt-8">
        <div>
          <div class="flex items-center mb-4">
            <img src="logo-gabarit-kdp-site-web.png" alt="GabaritKDP" class="h-8 w-auto">
            <span class="ml-2 text-white font-bold">GabaritKDP</span>
          </div>
          <p class="text-gray-400" data-en="The generator for 100% Amazon-compliant KDP covers." data-fr="Le g√©n√©rateur de couvertures KDP 100% conformes pour Amazon.">The generator for 100% Amazon-compliant KDP covers.</p>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-4" data-en="Product" data-fr="Produit">Product</h4>
          <ul class="space-y-2">
            <li><a href="./generator.html" class="hover:text-white transition" data-en="Express Generator" data-fr="G√©n√©rateur Express">Express Generator</a></li>
            <li><a href="./generator-magic.html" class="hover:text-white transition" data-en="Magic Generator" data-fr="G√©n√©rateur Magique">Magic Generator</a></li>
            <li><a href="./marketplace.html" class="hover:text-white transition" data-en="Templates" data-fr="Templates">Templates</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-4" data-en="Support" data-fr="Support">Support</h4>
          <ul class="space-y-2">
            <li><a href="./faq.html" class="hover:text-white transition" data-en="FAQ" data-fr="FAQ">FAQ</a></li>
            <li><a href="./contact.html" class="hover:text-white transition" data-en="Contact" data-fr="Contact">Contact</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-4" data-en="Legal" data-fr="L√©gal">Legal</h4>
          <ul class="space-y-2">
            <li><a href="./mentions-legales.html" class="hover:text-white transition" data-en="Legal Notice" data-fr="Mentions L√©gales">Legal Notice</a></li>
            <li><a href="./cgu.html" class="hover:text-white transition" data-en="Terms of Service" data-fr="Conditions d'utilisation">Terms of Service</a></li>
          </ul>
        </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center">
        <p>&copy; 2025 GabaritKDP. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    const config = {
      premium: [
        { name: "Art", path: "FULL COVER/Art", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/Art/STYLE%20PICASSO/fullcover_art_style_picasso_007.jpg", badge: "PREMIUM" },
        { name: "Boheme", path: "FULL COVER/Boheme", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/Boheme/fullcover_couverture_de_livres_boheme_003.jpg" },
        { name: "Fantasy", path: "FULL COVER/FANTASY", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/FANTASY/EPIC%20FANTASY/fullcover_fantasy_epic_fantasy_030.jpg", badge: "POPULAR" },
        { name: "Fleurs", path: "FULL COVER/Fleurs", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/Fleurs/fullcover_couverture_de_livres_fleurs_006.png" },
        { name: "Historical", path: "FULL COVER/Historical" },
        { name: "Horror", path: "FULL COVER/Horror", badge: "NEW" },
        { name: "Mystery", path: "FULL COVER/Mystery" },
        { name: "Religions", path: "FULL COVER/RELIGIONS", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/RELIGIONS/CHRISTIANISME/Style%20Louange%20%20Gospel/fullcover_religions_christianisme_style_louange_gospel_007.jpg" },
        { name: "Romance", path: "FULL COVER/Romance", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/Romance/Romance%20Intense%20%20Passion%20%20Enemies-to-lovers/fullcover_romance_contemporary_romance_intense_passion_enemies_to_lovers_006.jpg", badge: "BEST" },
        { name: "Sci-Fi", path: "FULL COVER/Sci-fi" },
        { name: "Thriller", path: "FULL COVER/Thriller" },
        { name: "Voyages", path: "FULL COVER/Voyages/MARRAKECH", img: "https://gabaritkdp.b-cdn.net/FULL%20COVER/Voyages/MARRAKECH/fullcover_voyages_marrakech_017.jpg" }
      ],
      backgrounds: [
        { name: "Romance", path: "backgrounds/ROMANCE", img: "https://gabaritkdp.b-cdn.net/backgrounds/vignette.webp" },
        { name: "Thriller", path: "backgrounds/THRILLER", img: "https://gabaritkdp.b-cdn.net/backgrounds/THRILLER/THRILLER%20%E2%80%93%20NOIR/image_couverture_de_livres_thriller_thriller_noir_012.png" },
        { name: "Fantasy", path: "backgrounds/FANTASY", img: "https://gabaritkdp.b-cdn.net/backgrounds/FANTASY/DARK%20FANTASY/image_couverture_de_livres_fantasy_dark_fantasy_006.png" },
        { name: "Mystery", path: "backgrounds/MYSTERY", img: "https://gabaritkdp.b-cdn.net/backgrounds/MYSTERY/Cozy%20Mystery/image_couverture_de_livres_mystery_cozy_mystery_001.png" },
        { name: "Sci-Fi", path: "backgrounds/SCI-FI", img: "https://gabaritkdp.b-cdn.net/backgrounds/SCI-FI/TECH%20ROMANCE%20%20AI/image_couverture_de_livres_sci_fi_tech_romance_ai_001.png" },
        { name: "Historical", path: "backgrounds/HISTORICAL", img: "https://gabaritkdp.b-cdn.net/backgrounds/HISTORICAL/Medieval/Medieval/image_couverture_de_livres_historical_medieval_010.png" },
        { name: "Boheme", path: "backgrounds/BOHEME", img: "https://gabaritkdp.b-cdn.net/backgrounds/BOHEME/Boheme_152.png" },
        { name: "Hippie", path: "backgrounds/HIPPIE", img: "https://gabaritkdp.b-cdn.net/backgrounds/HIPPIE/image_couverture_de_livres_hippie_001.png" },
        { name: "Business", path: "backgrounds/BUSINESS", img: "https://gabaritkdp.b-cdn.net/backgrounds/BUSINESS/Entrepreneurship/image_couverture_de_livres_business_entrepreneurship_011.png" },
        { name: "Cartoon", path: "backgrounds/CARTOON", img: "https://gabaritkdp.b-cdn.net/backgrounds/CARTOON/Animaux%20cartoon/image_couverture_de_livres_cartoon_animaux_cartoon_001.png" },
        { name: "Animals", path: "backgrounds/ANIMAUX", img: "https://gabaritkdp.b-cdn.net/backgrounds/ANIMAUX/Loups/Loups/image_couverture_de_livres_animaux_loups_004.png" }
      ],
      interiors: [
        { name: "Planners", url: "category-planners.html", img: "https://gabaritkdp.b-cdn.net/UI/book-interiors/Vignettes%20PLANNERS%202026.png", badge: "BEST SELLER" },
        { name: "Coloring Books", url: "category-coloriages.html", img: "https://gabaritkdp.b-cdn.net/UI/book-interiors/Vignette%20COLORING%20BOOKS.png" }
      ]
    };

    const BUNNY_CDN_BASE = "https://gabaritkdp.b-cdn.net/";
    function bunnyJoin(path){ 
      return BUNNY_CDN_BASE + encodeURIComponent(path).replace(/%2F/g,'/') + "/";
    }
    function vignetteCandidates(folderPath){
      const base = bunnyJoin(folderPath);
      return [base + "vignette.webp", base + "vignette.png", base + "vignette.jpg"];
    }
    function handleVignetteError(imgEl, folderPath){
      try{
        const tries = parseInt(imgEl.getAttribute('data-try') || '0', 10);
        const cands = vignetteCandidates(folderPath);
        if(tries < cands.length){
          imgEl.setAttribute('data-try', String(tries+1));
          imgEl.src = cands[tries];
          return;
        }
      }catch(e){}
      imgEl.src = "https://gabaritkdp.b-cdn.net/backgrounds/vignette.webp";
    }

    function render(data, gridId, isInterior = false) {
      const grid = document.getElementById(gridId);
      if (!grid) return;
      grid.innerHTML = "";
      data.forEach(item => {
        const link = isInterior ? item.url : `category.html?path=${encodeURIComponent(item.path)}`;
        grid.innerHTML += `
          <div class="category-card" onclick="location.href='${link}'">
            <img src="${(item.img && !String(item.img).includes('...')) ? item.img : vignetteCandidates(item.path)[0]}" loading="lazy" data-try="1" onerror="handleVignetteError(this, '${item.path}')">
            ${item.badge ? `<span class="category-badge ${item.badge.includes('PREMIUM') ? 'badge-premium' : (item.badge.includes('POPULAR') ? 'badge-popular' : 'badge-best')}">${item.badge}</span>` : ''}
            <div class="category-overlay">
              <div class="category-name">${item.name}</div>
            </div>
          </div>`;
      });
    }

    function switchLanguage(lang) {
      localStorage.setItem('preferredLanguage', lang);
      document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.lang === lang));
      document.querySelectorAll('[data-fr][data-en]').forEach(el => {
        el.innerText = el.getAttribute(`data-${lang}`);
      });
    }

    /* =======================
       PIXABAY (INTEGRATION AVANCEE)
       ======================= */
    const PIXABAY_API_KEY = "54299270-a26f023b47f440fc2718be4ac";
    let gkdpPixabayMode = "vertical"; // vertical=portrait, horizontal=landscape

    // Gestion du style des boutons Portrait/Landscape
    function gkdpPixabaySetMode(mode){
      gkdpPixabayMode = mode;
      const btnV = document.getElementById("gkdp-pixabay-tab-v");
      const btnH = document.getElementById("gkdp-pixabay-tab-h");
      
      if(btnV && btnH) {
          if (mode === "vertical") {
            btnV.classList.add("bg-orange-500", "text-white", "shadow-md");
            btnV.classList.remove("hover:bg-gray-100");
            btnH.classList.remove("bg-orange-500", "text-white", "shadow-md");
            btnH.classList.add("hover:bg-gray-100");
          } else {
            btnH.classList.add("bg-orange-500", "text-white", "shadow-md");
            btnH.classList.remove("hover:bg-gray-100");
            btnV.classList.remove("bg-orange-500", "text-white", "shadow-md");
            btnV.classList.add("hover:bg-gray-100");
          }
      }
    }

    async function gkdpPixabayLoad(q = ""){
      const grid = document.getElementById("gkdp-pixabay-grid");
      if (!grid) return;

      // R√©cup√©ration des filtres
      const inputQuery = document.getElementById("gkdp-pixabay-query")?.value || "";
      const query = q || inputQuery || (gkdpPixabayMode === "vertical" ? "background texture" : "landscape nature");
      
      const imageType = document.getElementById("pix-type")?.value || "all";
      const category = document.getElementById("pix-category")?.value || "";
      const colors = document.getElementById("pix-color")?.value || "";
      const order = document.getElementById("pix-order")?.value || "popular";

      let url = `https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${encodeURIComponent(query)}`;
      url += `&orientation=${gkdpPixabayMode}`;
      url += `&image_type=${imageType}`;
      url += `&order=${order}`;
      if(category) url += `&category=${category}`;
      if(colors) url += `&colors=${colors}`;
      url += `&per_page=20&safesearch=true`; 

      // Indicateur de chargement
      grid.innerHTML = '<div class="col-span-full text-center py-10"><i class="fas fa-spinner fa-spin text-4xl text-orange-500"></i></div>';

      try{
        const res = await fetch(url);
        const data = await res.json();
        grid.innerHTML = "";

        if(data.hits.length === 0) {
            grid.innerHTML = `<div class="col-span-full text-center text-gray-500 py-10">
                <i class="fa-regular fa-face-frown text-2xl mb-2"></i><br>
                ${(localStorage.getItem("preferredLanguage") === "fr") ? "Aucun r√©sultat trouv√©." : "No results found."}
            </div>`;
            return;
        }

        (data.hits || []).forEach(photo => {
          const card = document.createElement("div");
          card.className = "category-card group"; 
          if (gkdpPixabayMode === "horizontal") {
              card.style.aspectRatio = "16/9";
          } else {
              card.style.aspectRatio = "2/3";
          }

          const lang = localStorage.getItem("preferredLanguage") || "en";
          const label = lang === "fr" ? "Utiliser" : "Use";
          const tags = photo.tags.split(',').slice(0,3).join(', ');

          card.innerHTML = `
            <img src="${photo.webformatURL}" class="transition duration-500 group-hover:scale-110" loading="lazy" alt="${photo.tags}">
            <div class="category-overlay opacity-0 group-hover:opacity-100 transition duration-300" style="pointer-events:auto">
              <span class="text-xs text-gray-200 mb-2 truncate px-2">${tags}</span>
              <button type="button" class="mt-1 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg shadow-lg transform hover:scale-105 transition">
                ${label}
              </button>
            </div>
            <div class="absolute top-2 left-2 bg-black/50 text-white text-[10px] px-2 py-1 rounded backdrop-blur-sm pointer-events-none">
                ${photo.type}
            </div>
          `;

          card.querySelector("button").addEventListener("click", (e) => {
            e.preventDefault();
            e.stopPropagation();
            const img = encodeURIComponent(photo.largeImageURL);
            const param = (gkdpPixabayMode === "horizontal")
              ? `template=${img}&src=pixabay` 
              : `img=${img}&src=pixabay`;
            window.location.href = `./generator.html?trim=6x9&${param}`;
          });

          grid.appendChild(card);
        });
      }catch(err){
        console.error("[PIXABAY] error", err);
        grid.innerHTML = `<p class="col-span-full text-center text-red-500">Error loading Pixabay images.</p>`;
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      render(config.premium, 'grid-premium');
      render(config.backgrounds, 'grid-backgrounds');
      render(config.interiors, 'grid-interiors', true);
      switchLanguage(localStorage.getItem('preferredLanguage') || 'en');

      // üî• PIXABAY EVENTS
      const triggerSearch = () => gkdpPixabayLoad();

      document.getElementById("gkdp-pixabay-tab-v")?.addEventListener("click", () => {
        gkdpPixabaySetMode("vertical");
        triggerSearch();
      });
      document.getElementById("gkdp-pixabay-tab-h")?.addEventListener("click", () => {
        gkdpPixabaySetMode("horizontal");
        triggerSearch();
      });
      document.getElementById("gkdp-pixabay-search-btn")?.addEventListener("click", triggerSearch);
      document.getElementById("gkdp-pixabay-query")?.addEventListener("keypress", (e) => {
          if(e.key === 'Enter') triggerSearch();
      });

      // Filtres dynamiques
      ['pix-type', 'pix-category', 'pix-color', 'pix-order'].forEach(id => {
          document.getElementById(id)?.addEventListener("change", triggerSearch);
      });

      // Initialisation
      gkdpPixabaySetMode("vertical");
      triggerSearch();
    });
  </script>
</body>
</html>