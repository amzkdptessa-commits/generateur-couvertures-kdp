import{r as s,a as _,R as S}from"./react-vendor-wGySg1uH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function d(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=d(e);fetch(e.href,o)}})();var y={exports:{}},p={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R=s,k=Symbol.for("react.element"),j=Symbol.for("react.fragment"),E=Object.prototype.hasOwnProperty,A=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,I={key:!0,ref:!0,__self:!0,__source:!0};function x(c,t,d){var r,e={},o=null,a=null;d!==void 0&&(o=""+d),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)E.call(t,r)&&!I.hasOwnProperty(r)&&(e[r]=t[r]);if(c&&c.defaultProps)for(r in t=c.defaultProps,t)e[r]===void 0&&(e[r]=t[r]);return{$$typeof:k,type:c,key:o,ref:a,props:e,_owner:A.current}}p.Fragment=j;p.jsx=x;p.jsxs=x;y.exports=p;var n=y.exports,g={},v=_;g.createRoot=v.createRoot,g.hydrateRoot=v.hydrateRoot;function N(){const[c,t]=s.useState("idle"),[d,r]=s.useState(""),[e,o]=s.useState(""),[a,h]=s.useState("");s.useEffect(()=>{window.dispatchEvent(new CustomEvent("gkdp:react-mounted"))},[]);const f=s.useCallback(async()=>{var i,u,l,m;try{if(!window.CanvaAuth){t("notauthed");return}await((u=(i=window.CanvaAuth).refreshIfNeeded)==null?void 0:u.call(i));const w=(m=(l=window.CanvaAuth).isAuthenticated)==null?void 0:m.call(l);t(w?"authed":"notauthed")}catch{t("notauthed")}},[]);s.useEffect(()=>{f()},[f]);const C=s.useCallback(()=>{try{if(window.CanvaAuth&&typeof window.CanvaAuth.initiateConnection=="function"){window.CanvaAuth.initiateConnection();return}alert("CanvaAuth n‚Äôest pas initialis√©. V√©rifie generator.html.")}catch(i){console.error("[CANVA][CONNECT] error",i),alert("Erreur connexion Canva (voir console).")}},[]);return s.useEffect(()=>(window.__kdp_canva_onSelected=({imageUrl:i,target:u})=>{const l=String(u||"front").toLowerCase();i&&(l.includes("spine")?o(i):l.includes("back")?h(i):r(i))},()=>{}),[]),n.jsxs("div",{style:{padding:16,color:"#e5e7eb"},children:[n.jsx("h2",{style:{margin:"0 0 12px",fontSize:18},children:"KDP Generator"}),n.jsxs("div",{style:{background:"rgba(255,255,255,.06)",border:"1px solid rgba(255,255,255,.10)",borderRadius:14,padding:14,maxWidth:780},children:[n.jsx("h3",{style:{margin:0,fontSize:15},children:"Import from Canva"}),n.jsxs("p",{style:{margin:"6px 0 12px",opacity:.85,fontSize:13},children:["Statut Canva : ",n.jsx("b",{children:c})]}),n.jsx("button",{type:"button",onClick:C,style:{height:42,padding:"0 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.18)",background:"#2563eb",color:"white",fontWeight:800,cursor:"pointer"},children:"Connect Canva"}),n.jsx("button",{type:"button",onClick:f,style:{height:42,padding:"0 14px",marginLeft:10,borderRadius:12,border:"1px solid rgba(255,255,255,.18)",background:"rgba(255,255,255,.06)",color:"white",fontWeight:800,cursor:"pointer"},children:"Refresh status"}),n.jsxs("div",{style:{display:"grid",gap:10,marginTop:14},children:[n.jsxs("label",{style:{fontSize:13,opacity:.9},children:["Front image URL",n.jsx("input",{value:d,onChange:i=>r(i.target.value),style:{width:"100%",marginTop:6,height:38,borderRadius:10,border:"1px solid rgba(255,255,255,.14)",background:"rgba(0,0,0,.25)",color:"white",padding:"0 10px"},placeholder:"(rempli quand Canva import)"})]}),n.jsxs("label",{style:{fontSize:13,opacity:.9},children:["Spine image URL",n.jsx("input",{value:e,onChange:i=>o(i.target.value),style:{width:"100%",marginTop:6,height:38,borderRadius:10,border:"1px solid rgba(255,255,255,.14)",background:"rgba(0,0,0,.25)",color:"white",padding:"0 10px"},placeholder:"(rempli quand Canva import)"})]}),n.jsxs("label",{style:{fontSize:13,opacity:.9},children:["Back image URL",n.jsx("input",{value:a,onChange:i=>h(i.target.value),style:{width:"100%",marginTop:6,height:38,borderRadius:10,border:"1px solid rgba(255,255,255,.14)",background:"rgba(0,0,0,.25)",color:"white",padding:"0 10px"},placeholder:"(rempli quand Canva import)"})]})]})]})]})}function O({onFrontImage:c,onBackImage:t,onSpineImage:d}){s.useEffect(()=>(console.log("üîó [CANVA BRIDGE] Initialisation"),window.__kdp_canva_onSelected=function(r,e){e&&(console.log(`üé® [CANVA] Image re√ßue - side: ${r}, url: ${e}`),r==="back"&&t?t(e):r==="spine"&&d?d(e):c&&c(e))},console.log("‚úÖ [CANVA BRIDGE] Pr√™t - window.__kdp_canva_onSelected cr√©√©"),()=>{console.log("üîå [CANVA BRIDGE] Nettoyage"),delete window.__kdp_canva_onSelected}),[c,t,d])}function L(){const[c,t]=s.useState(null),[d,r]=s.useState(null),[e,o]=s.useState(null);return O({onFrontImage:a=>{console.log("üì• Front image depuis Canva:",a),t(a)},onBackImage:a=>{console.log("üì• Back image depuis Canva:",a),r(a)},onSpineImage:a=>{console.log("üì• Spine image depuis Canva:",a),o(a)}}),n.jsx("div",{className:"app",children:n.jsx(N,{canvaFrontImage:c,canvaBackImage:d,canvaSpineImage:e})})}const b=document.getElementById("kdp-react-root")||document.getElementById("root");b?g.createRoot(b).render(n.jsx(S.StrictMode,{children:n.jsx(L,{})})):console.error("‚ùå Root element not found! Looking for #kdp-react-root or #root");
