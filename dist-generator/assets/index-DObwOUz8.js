import{r as s,a as p,R as g}from"./react-vendor-wGySg1uH.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(e){if(e.ep)return;e.ep=!0;const c=a(e);fetch(e.href,c)}})();var v={exports:{}},l={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C=s,h=Symbol.for("react.element"),A=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,w=C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function m(t,o,a){var n,e={},c=null,i=null;a!==void 0&&(c=""+a),o.key!==void 0&&(c=""+o.key),o.ref!==void 0&&(i=o.ref);for(n in o)_.call(o,n)&&!x.hasOwnProperty(n)&&(e[n]=o[n]);if(t&&t.defaultProps)for(n in o=t.defaultProps,o)e[n]===void 0&&(e[n]=o[n]);return{$$typeof:h,type:t,key:c,ref:i,props:e,_owner:w.current}}l.Fragment=A;l.jsx=m;l.jsxs=m;v.exports=l;var r=v.exports,d={},u=p;d.createRoot=u.createRoot,d.hydrateRoot=u.hydrateRoot;function y({setFrontUrl:t,setBackUrl:o,setSpineUrl:a}){s.useEffect(()=>(console.log("üîó [CANVA BRIDGE] Initialisation du bridge React ‚Üî Canva"),window.__kdp_canva_onSelected=(n,e)=>{if(!e){console.warn("‚ö†Ô∏è [CANVA BRIDGE] URL vide re√ßue");return}console.log("üé® [CANVA BRIDGE] Image Canva s√©lectionn√©e:",{side:n,url:e}),n==="back"?o(e):n==="spine"?a==null||a(e):t(e)},console.log("‚úÖ [CANVA BRIDGE] Callback global window.__kdp_canva_onSelected cr√©√©"),()=>{console.log("üßπ [CANVA BRIDGE] Nettoyage du callback"),delete window.__kdp_canva_onSelected}),[t,o,a])}function E(t=8e3){return new Promise((o,a)=>{const n=Date.now(),e=()=>{if(window.CanvaAuth&&typeof window.CanvaAuth.initiateConnection=="function")return console.log("‚úÖ [CANVA AUTH] window.CanvaAuth d√©tect√© et pr√™t"),o(window.CanvaAuth);if(Date.now()-n>t)return console.error("‚ùå [CANVA AUTH] Timeout - CanvaAuth non disponible"),a(new Error("CanvaAuth not ready (timeout)"));setTimeout(e,50)};e()})}async function I(){try{console.log("üîÑ [CANVA AUTH] Connexion √† Canva..."),await(await E()).initiateConnection(),console.log("‚úÖ [CANVA AUTH] Connexion initi√©e avec succ√®s")}catch(t){throw console.error("‚ùå [CANVA AUTH] Erreur de connexion:",t),t}}function k(){const[t,o]=s.useState({front:null,back:null,spine:null});y({setFrontUrl:n=>{console.log("üì• Front cover from Canva:",n),o(e=>({...e,front:n}))},setBackUrl:n=>{console.log("üì• Back cover from Canva:",n),o(e=>({...e,back:n}))},setSpineUrl:n=>{console.log("üì• Spine from Canva:",n),o(e=>({...e,spine:n}))}}),s.useEffect(()=>{window.dispatchEvent(new Event("gkdp:react-mounted")),console.log("‚úÖ React mont√© - Canva UI peut s'attacher maintenant")},[]);const a=async()=>{try{await I(),alert("Connexion √† Canva r√©ussie !")}catch(n){alert("Erreur de connexion √† Canva. V√©rifiez la console."),console.error(n)}};return r.jsxs("div",{className:"kdp-generator",children:[r.jsxs("div",{className:"canva-import-section",children:[r.jsx("h3",{children:"üé® Import from Canva"}),r.jsx("button",{onClick:a,className:"canva-connect-btn",children:"Connect to Canva"}),r.jsx("div",{id:"canva-designs-container",style:{minHeight:100,marginTop:20}})]}),r.jsxs("div",{className:"cover-preview",children:[r.jsx("h3",{children:"Cover Preview"}),t.front&&r.jsxs("div",{children:[r.jsx("p",{children:"Front Cover:"}),r.jsx("img",{src:t.front,alt:"Front",style:{maxWidth:200}})]}),t.back&&r.jsxs("div",{children:[r.jsx("p",{children:"Back Cover:"}),r.jsx("img",{src:t.back,alt:"Back",style:{maxWidth:200}})]}),t.spine&&r.jsxs("div",{children:[r.jsx("p",{children:"Spine:"}),r.jsx("img",{src:t.spine,alt:"Spine",style:{maxWidth:50}})]})]})]})}function N({onFrontImage:t,onBackImage:o,onSpineImage:a}){s.useEffect(()=>(console.log("üîó [CANVA BRIDGE] Initialisation"),window.__kdp_canva_onSelected=function(n,e){e&&(console.log(`üé® [CANVA] Image re√ßue - side: ${n}, url: ${e}`),n==="back"&&o?o(e):n==="spine"&&a?a(e):t&&t(e))},console.log("‚úÖ [CANVA BRIDGE] Pr√™t - window.__kdp_canva_onSelected cr√©√©"),()=>{console.log("üîå [CANVA BRIDGE] Nettoyage"),delete window.__kdp_canva_onSelected}),[t,o,a])}function R(){const[t,o]=s.useState(null),[a,n]=s.useState(null),[e,c]=s.useState(null);return N({onFrontImage:i=>{console.log("üì• Front image depuis Canva:",i),o(i)},onBackImage:i=>{console.log("üì• Back image depuis Canva:",i),n(i)},onSpineImage:i=>{console.log("üì• Spine image depuis Canva:",i),c(i)}}),r.jsx("div",{className:"app",children:r.jsx(k,{canvaFrontImage:t,canvaBackImage:a,canvaSpineImage:e})})}const f=document.getElementById("kdp-react-root")||document.getElementById("root");f?d.createRoot(f).render(r.jsx(g.StrictMode,{children:r.jsx(R,{})})):console.error("‚ùå Root element not found! Looking for #kdp-react-root or #root");
