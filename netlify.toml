# Configuration Netlify pour GabaritKDP

[build]
  # Dossier des functions serverless
  functions = "netlify/functions"

  # Site statique, pas de build
  command = ""
  publish = "."

[functions]
  # Bundler des functions
  node_bundler = "esbuild"

# =========================
# Proxy vers React App (Cloud Run)
# =========================
[[redirects]]
  from = "/generator.html"
  to = "https://kdp-cover-generator-586405206336.us-west1.run.app/"
  status = 200
  force = true

[[redirects]]
  from = "/generator.html/*"
  to = "https://kdp-cover-generator-586405206336.us-west1.run.app/:splat"
  status = 200
  force = true

# Assets de l'app React (JS, CSS, etc.)
[[redirects]]
  from = "/assets/*"
  to = "https://kdp-cover-generator-586405206336.us-west1.run.app/assets/:splat"
  status = 200
  force = true

# =========================
# Redirect API KDP
# =========================
[[redirects]]
  from = "/api/kdp-sync"
  to = "/.netlify/functions/kdp-sync"
  status = 200

# =========================
# Headers globaux
# =========================
[[headers]]
  for = "/*"
  [headers.values]
    Access-Control-Allow-Origin = "*"
    Access-Control-Allow-Methods = "GET, POST, OPTIONS"
    Access-Control-Allow-Headers = "Content-Type"

    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
